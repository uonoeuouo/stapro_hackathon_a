generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Employee {
  id                Int      @id @default(autoincrement())
  name              String
  external_staff_id Int?     @unique
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  cards            Card[]
  attendances      Attendance[]
  commuteTemplates CommuteTemplate[]
}

model Card {
  id          Int      @id @default(autoincrement())
  employee_id Int
  card_id     String   @unique
  name        String?
  is_active   Boolean  @default(true)
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt

  employee Employee @relation(fields: [employee_id], references: [id], onDelete: Cascade)

  @@index([employee_id])
  @@index([card_id])
}

model Attendance {
  id                     Int      @id @default(autoincrement())
  employee_id            Int
  date                   DateTime
  clock_in_time          DateTime
  clock_out_time         DateTime?
  commute_info           Json?
  external_attendance_id Int?     @unique
  school_id              Int?
  createdAt              DateTime @default(now())
  updatedAt              DateTime @updatedAt

  employee Employee @relation(fields: [employee_id], references: [id])
}

model CommuteTemplate {
  id                Int      @id @default(autoincrement())
  employee_id       Int
  name              String
  cost              Int
  route_description String?
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  employee Employee @relation(fields: [employee_id], references: [id])
}
